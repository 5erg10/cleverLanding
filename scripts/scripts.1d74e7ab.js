"use strict";angular.module("smcApp",["ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("smcApp").controller("MainCtrl",function(){function a(){$("#malla").css("opacity","0.8")}function b(){$("#play").removeClass("hidden"),$("#pause").addClass("hidden")}var c=["#92A7D1","#B1C1AA","#F7D285","#92A7D1","#B1C1AA","#F7D285","#92A7D1","#B1C1AA","#F7D285"],d=0;TweenMax.set(".bodyClass, .split-lines",{visibility:"visible"});var e=new TimelineMax({repeat:0});e.to(".scrollLegend",.5,{opacity:0,ease:Power2.easeOut}).to(".bodyClass",2,{backgroundColor:c[0],ease:Power2.easeOut,onComplete:a}).to(".ep0",.4,{className:"+=episodeActive",ease:Power2.easeOut}).to(".text1",1,{opacity:1,ease:Power2.easeOut},"-=1").to(".logo",.5,{left:"1%",top:"1%",height:"10%",ease:Back.easeIn},"episode0+=1").to(".text1",1,{opacity:0,ease:Power2.easeOut},"+=3").to(".ep0",.4,{className:"-=episodeActive",ease:Power2.easeOut}).to(".ep01",.4,{className:"+=capActive",ease:Power2.easeOut}).to(".text0",1,{opacity:1,ease:Power2.easeOut}).to(".text0",1,{opacity:0,ease:Power2.easeOut},"episode1+=4").to(".ep01",.4,{className:"-=capActive",ease:Power2.easeOut}).to(".ep1",.4,{className:"+=episodeActive",ease:Power2.easeOut}).to(".bodyClass",2,{backgroundColor:c[1],ease:Power2.easeOut}).to(".cell1",1,{opacity:1,ease:Back.easeOut},"-=1").to(".text2",1,{opacity:1,ease:Power2.easeOut},"-=0.5").to(".text2",1,{opacity:0,ease:Power2.easeOut},"episode2+=5").to(".text3",1,{opacity:1,ease:Power2.easeOut},"+=0.5").to(".ep1",.4,{className:"-=episodeActive",ease:Power2.easeOut}).to(".ep11",.4,{className:"+=capActive",ease:Power2.easeOut}).to(".cell3",.3,{opacity:1,repeat:10,yoyo:!0,repeatDelay:.1,ease:Back.easeOut},"cellLearn").to(".cell4",.3,{opacity:1,repeat:10,yoyo:!0,repeatDelay:.1,ease:Back.easeOut},"cellLearn+=0.6").to(".cell2",1,{opacity:1,repeat:5,yoyo:!0,repeatDelay:.1,ease:Power2.easeOut}).to(".text3",1,{opacity:0,ease:Power2.easeOut},"episode3+=3").to(".celula",1,{opacity:0,ease:Power2.easeOut}).to(".text31",1,{opacity:1,ease:Power2.easeOut}).to(".ep11",.4,{className:"-=capActive",ease:Power2.easeOut}).to(".ep12",.4,{className:"+=capActive",ease:Power2.easeOut}).to(".bikaStep2",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep3",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep4",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep6",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep8",.5,{opacity:1,scale:1,ease:Linear.easeNone}).to(".bikaStep7",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep5",.5,{opacity:1,scale:1,ease:Linear.easeNone}).to(".bikaStep9",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep10",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep11",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".text31",1,{opacity:0,ease:Power2.easeOut},"episode4+=2").staggerTo(".bika",.2,{opacity:0,scale:0,ease:Back.easeIn},.2).to(".text32",1,{opacity:1,ease:Power2.easeOut},"+=1").to(".bikaStep12",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep13",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep14",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep15",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep16",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep17",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep18",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep19",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep20",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep21",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep22",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".text32",1,{opacity:0,ease:Power2.easeOut},"+=2").staggerTo(".bika2",.2,{opacity:0,scale:0,ease:Back.easeIn},.2).to(".text33",1,{opacity:1,ease:Power2.easeOut},"+=1").to(".bikaStep23",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep24",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep25",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep26",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep27",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep28",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep29",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep30",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep31",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep32",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep33",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep34",.5,{opacity:1,scale:1,ease:Back.easeOut}).staggerTo(".bika3",.2,{opacity:0,scale:0,ease:Back.easeIn},.2).to(".text33",1,{opacity:0,ease:Power2.easeOut},"+=2").to(".text34",1,{opacity:1,ease:Power2.easeOut},"+=1").to(".bikaStep35",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep36",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep37",.5,{opacity:1,scale:1,ease:Linear.easeNone}).to(".bikaStep38",.5,{opacity:1,scale:1,ease:Linear.easeNone}).to(".bikaStep39",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep40",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep41",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep42",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep43",.5,{opacity:1,scale:1,ease:Back.easeOut}).to(".bikaStep44",.5,{opacity:1,scale:1,ease:Back.easeOut}).staggerTo(".bika4",.2,{opacity:0,scale:0,ease:Back.easeIn},.2).to(".text34",1,{opacity:0,ease:Power2.easeOut},"+=2").to(".ep12",.4,{className:"-=capActive",ease:Power2.easeOut}).to(".ep2",.4,{className:"+=episodeActive",onCompleteParams:[2],ease:Power2.easeOut}).to(".bodyClass",2,{backgroundColor:c[3],ease:Power2.easeOut}).to(".ecosistema",1,{top:"-8%",left:"-2%",width:"60%",scale:1,ease:Power2.easeOut},"+=0.5").to(".text41",1,{opacity:1,ease:Power2.easeOut},"+=0.5").to(".general",1,{opacity:1,repeat:6,yoyo:!0,repeatDelay:.3,ease:Power2.easeOut},"episode5").to(".text41",1,{opacity:0,ease:Power2.easeOut},"+=2").to(".ep2",.4,{className:"-=episodeActive",ease:Power2.easeOut}).to(".ep21",.4,{className:"+=capActive",ease:Power2.easeOut}).to(".text42",1,{opacity:1,ease:Power2.easeOut}).to(".text42",1,{opacity:0,ease:Power2.easeOut},"episode6+=4").to(".ep21",.4,{className:"-=capActive",ease:Power2.easeOut}).to(".ep22",.4,{className:"+=capActive",ease:Power2.easeOut}).to(".text43",1,{opacity:1,ease:Power2.easeOut}).to(".text43",1,{opacity:0,ease:Power2.easeOut},"episode7+=4").to(".ep22",.4,{className:"-=capActive",ease:Power2.easeOut}).to(".ep3",.4,{className:"+=episodeActive",onCompleteParams:[3],ease:Power2.easeOut}).to(".bodyClass",2,{backgroundColor:c[4],ease:Power2.easeOut}).to(".ecosistema",1,{top:"15%",left:"17%",width:"34%",scale:1,ease:Power2.easeOut},"+=0.5").to(".text4",1,{opacity:1,ease:Power2.easeOut},"-=1").to(".avatar",1,{opacity:1,bottom:"-1%",ease:Power2.easeOut},"episode8","+=0.5").to(".arrows",.3,{opacity:.7,repeat:5,yoyo:!0,repeatDelay:.3,ease:Power0.easeNone}).to(".text4",1,{opacity:0,ease:Power2.easeOut}).to(".ep3",.4,{className:"-=episodeActive",ease:Power2.easeOut}).to(".ep31",.4,{className:"+=capActive",ease:Power2.easeOut}).to(".bodyClass",2,{backgroundColor:c[2],ease:Power2.easeOut}).to(".ecosistema",1,{top:"-24%",left:"-24%",width:"95%",scale:1,ease:Back.easeIn},"-=0.5").to(".text5",1,{opacity:1,top:"50%",ease:Power2.easeOut},"+=0.5").to(".text5",.01,{opacity:1,top:"50%",ease:Power2.easeOut},"episode9").to(".actv8",.5,{opacity:1,repeat:4,repeatDelay:.3,ease:Back.easeOut},"comunication3").to(".actv7",.5,{opacity:1,repeat:4,repeatDelay:.3,ease:Back.easeOut},"comunication3+=0.2").to(".actv19",.5,{opacity:1,repeat:4,repeatDelay:.3,ease:Back.easeOut}).to(".actv5",.5,{opacity:1,repeat:4,repeatDelay:.3,ease:Back.easeOut},"comunication4").to(".actv6",.5,{opacity:1,repeat:4,repeatDelay:.3,ease:Back.easeOut},"comunication4+=0.2").to(".actv17",.5,{opacity:1,repeat:4,repeatDelay:.3,ease:Back.easeOut}).to(".actv10",.5,{opacity:1,repeat:4,repeatDelay:.3,ease:Back.easeOut},"comunication5").to(".actv9",.5,{opacity:1,repeat:4,repeatDelay:.3,ease:Back.easeOut},"comunication5+=0.2").to(".ep31",.4,{className:"-=capActive",ease:Power2.easeOut}).to(".ep32",.4,{className:"+=capActive",ease:Power2.easeOut}).to(".text5",1,{opacity:0,ease:Power2.easeOut},"+=1").to(".ecosistema",1,{top:"15%",left:"17%",width:"34%",scale:1,ease:Back.easeIn},"+=0.5").to(".text6",1,{opacity:1,ease:Power2.easeOut},"-=1").to(".text6",.001,{opacity:1,ease:Power2.easeOut},"episode10").to(".arrows2",.3,{opacity:.7,repeat:5,yoyo:!0,repeatDelay:.3,ease:Power0.easeNone}).to(".van",1,{opacity:1,bottom:"-1%",ease:Power2.easeOut},"-=1.5").to(".avatar",1,{opacity:0,bottom:"-30%",ease:Power2.easeOut},"avatar").to(".van",1,{opacity:0,bottom:"-30%",ease:Power2.easeOut},"avatar").to(".general",.5,{opacity:0,ease:Back.easeOut},"+=1").to(".text6",1,{opacity:0,ease:Power2.easeOut}).to(".ecosistema",.5,{top:"-150%",left:"0%",scale:0,ease:Back.easeIn},"+=0.5").to(".ep32",.4,{className:"-=capActive",ease:Power2.easeOut}).to(".ep4",.4,{className:"+=episodeActive",onCompleteParams:[4],ease:Power2.easeOut}).to(".text7",1,{opacity:1,ease:Power2.easeOut}).to(".text7",1,{opacity:0,ease:Power2.easeOut},"episode11+=4").to(".bodyClass",2,{backgroundColor:c[5],ease:Power2.easeOut}).to(".ep4",.4,{className:"-=episodeActive",ease:Power2.easeOut}).to(".ep33",.4,{className:"+=capActive",ease:Power2.easeOut}).to(".text8",1,{opacity:1,ease:Power2.easeOut},"+=1").to(".text8",1,{opacity:0,ease:Power2.easeOut},"episode12+=4").to(".ep33",.4,{className:"-=capActive",ease:Power2.easeOut}).to(".ep5",.4,{className:"+=episodeActive",onCompleteParams:[5],ease:Power2.easeOut}).to(".bodyClass",2,{backgroundColor:c[2],ease:Power2.easeOut}).to(".text9",1,{opacity:1,ease:Power2.easeOut},"+=1").to(".downloadButton",1,{scale:1,ease:Power2.easeOut}).to(".text9",1,{opacity:1,ease:Power2.easeOut},"episode13+=1"),e.pause(),$(window).bind("mousewheel DOMMouseScroll mousedown",function(a){a.preventDefault(),"mousedown"!=a.type?a.originalEvent.wheelDelta>0||a.originalEvent.detail<0?($("#pause").removeClass("hidden"),$("#play").addClass("hidden"),d>0&&(console.log(d),TweenLite.from(e,.5,{progress:d,ease:Power0.easeNone,onComplete:b}),.01>d?d=0:d-=.001)):($("#pause").removeClass("hidden"),$("#play").addClass("hidden"),1>d&&(console.log(d),TweenLite.to(e,.5,{progress:d,ease:Power0.easeNone,onComplete:b}),d+=.001)):"mousedown"==a.type&&1==a.button&&(e.paused()?($("#pause").removeClass("hidden"),$("#play").addClass("hidden"),e.play()):($("#play").removeClass("hidden"),$("#pause").addClass("hidden"),e.pause()))}),$(".ep").click(function(){var a=[.015,.05,.09,.146,.2,.51,.58,.62,.662,.71,.835,.88,.93,.99];d=a[$(this).attr("name")],e.seek("episode"+$(this).attr("name")),$(".episodeNumber").removeClass("episodeHover")}),$(".controlButtonsGroup").click(function(){e.paused()?($("#play").addClass("hidden"),$("#pause").removeClass("hidden"),e.play()):($("#pause").addClass("hidden"),$("#play").removeClass("hidden"),e.pause())}),$(".episodeNumber").hover(function(){TweenMax.to(this,.3,{css:{className:"+=episodeHover"},ease:Power2.easeOut})},function(){TweenMax.to(this,.1,{css:{className:"-=episodeHover"},ease:Power2.easeOut})}),$(".CapNumber").hover(function(){TweenMax.to(this,.3,{css:{className:"+=capHover"},ease:Power2.easeOut})},function(){TweenMax.to(this,.1,{css:{className:"-=capHover"},ease:Power2.easeOut})})}),angular.module("smcApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("smcApp").directive("mallaGem",function(){return{restrict:"EA",scope:{},link:function(a,b){function c(){j=document.getElementById("malla"),k=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,4e3),k.position.z=100,l=new THREE.Scene,i=new THREE.Group,l.add(i);var a=y*y;n=new Float32Array(3*a),o=new Float32Array(3*a);var b=new THREE.PointCloudMaterial({color:13421772,size:6,blending:THREE.AdditiveBlending,transparent:!0,sizeAttenuation:!1});s=new THREE.BufferGeometry,q=new Float32Array(3*y);for(var c=0;y>c;c++){var g=Math.random()*A-A/2,h=Math.random()*A-A/2,u=Math.random()*A-A/2;q[3*c]=g,q[3*c+1]=h,q[3*c+2]=u,t.push({velocity:new THREE.Vector3(-.5+1*Math.random(),-.5+1*Math.random(),-.5+1*Math.random()),numConnections:0})}s.groups.push({start:0,count:z,index:0}),s.addAttribute("position",new THREE.DynamicBufferAttribute(q,3)),p=new THREE.PointCloud(s,b),i.add(p);var v=new THREE.BufferGeometry;v.addAttribute("position",new THREE.DynamicBufferAttribute(n,3)),v.addAttribute("color",new THREE.DynamicBufferAttribute(o,3)),v.computeBoundingSphere(),v.groups.push({start:0,count:0,index:0});var w=new THREE.LineBasicMaterial({color:13421772,blending:THREE.AdditiveBlending,transparent:!0});console.log(w),r=new THREE.Line(v,w,THREE.LinePieces),i.add(r),m=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),m.setPixelRatio(window.devicePixelRatio),m.setSize(window.innerWidth,window.innerHeight),m.setClearColor(0,0),m.gammaInput=!0,m.gammaOutput=!0,j.appendChild(m.domElement),document.addEventListener("mousemove",d,!1),document.addEventListener("mousewheel",e,!1),window.addEventListener("resize",f,!1)}function d(a){u=a.clientX/2-w,v=a.clientY/2-x}function e(a){a.wheelDelta>0?i.rotateX(-.03):i.rotateX(.03)}function f(){k.aspect=window.innerWidth/window.innerHeight,k.updateProjectionMatrix(),m.setSize(window.innerWidth-20,window.innerHeight-200)}function g(){for(var a=0,b=0,c=0,d=0;z>d;d++)t[d].numConnections=0;for(var d=0;z>d;d++){var e=t[d];if(q[3*d]+=e.velocity.x,q[3*d+1]+=e.velocity.y,q[3*d+2]+=e.velocity.z,(q[3*d+1]<-B||q[3*d+1]>B)&&(e.velocity.y=-e.velocity.y),(q[3*d]<-B||q[3*d]>B)&&(e.velocity.x=-e.velocity.x),(q[3*d+2]<-B||q[3*d+2]>B)&&(e.velocity.z=-e.velocity.z),!(C.limitConnections&&e.numConnections>=C.maxConnections))for(var f=d+1;z>f;f++){var i=t[f];if(!(C.limitConnections&&i.numConnections>=C.maxConnections)){var j=q[3*d]-q[3*f],k=q[3*d+1]-q[3*f+1],l=q[3*d+2]-q[3*f+2],m=Math.sqrt(j*j+k*k+l*l);if(m<C.minDistance){e.numConnections++,i.numConnections++;var s=1-m/C.minDistance;n[a++]=q[3*d],n[a++]=q[3*d+1],n[a++]=q[3*d+2],n[a++]=q[3*f],n[a++]=q[3*f+1],n[a++]=q[3*f+2],o[b++]=s,o[b++]=s,o[b++]=s,o[b++]=s,o[b++]=s,o[b++]=s,c++}}}}r.geometry.groups[0].count=2*c,r.geometry.attributes.position.needsUpdate=!0,r.geometry.attributes.color.needsUpdate=!0,p.geometry.attributes.position.needsUpdate=!0,requestAnimationFrame(g),h()}function h(){k.position.x+=.05*(u-k.position.x),k.position.y+=.05*(-v-k.position.y),k.lookAt(l.position),m.render(l,k)}var i,j,k,l,m,n,o,p,q,r,s,t=[],u=0,v=0,w=window.innerWidth/2,x=window.innerHeight/2,y=1e3,z=300,A=1e3,B=A/2,C={showDots:!0,showLines:!0,minDistance:150,limitConnections:!1,maxConnections:10,particleCount:300};c(),g()}}});